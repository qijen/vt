<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>vtPhysX: </title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="online.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="main.html">PhysX for Virtools</a>&nbsp;&raquo&nbsp;<a class="el" href="guide.html">Guide</a>&nbsp;&raquo&nbsp;<a class="el" href="collisions.html">Collisions</a>
  </div>
</div>
<div class="contents">
<p><b>Contact Filtering </b></p>
<p>In addition to the filtering mechanisms implemented using pWorld::setGroupCollisionFlag(), PWSetCollisionGroupFlag and pWorld::setShapePairFlags() the SDK provides a more sophisticated filtering mechanism based on boolean operations and flags.</p>
<p>The user is able to specify a 128 bit group mask for each shape. This mask is combined with user specified constants and operators, which results in a boolean value indicating if contacts should be generated for a pair of shapes. The shape culling operates according to the following pseudocode:</p>
<p>bool shouldGenerateContacts(shape0Bits, shape1Bits) <br/>
 { <br/>
 value = (shape0Bits op0 constant0) op2 (shape1Bits op1 constant1)<br/>
 return ((bool)value)==filterBool; <br/>
 }<br/>
</p>
<p>In other words, the bit mask associated with shape 0 is combined with constant 0 using operator 0. The bit mask associated with shape 1 is combined with constant 1 using operator 1. Finally, the two results are combined with operator 2 and compared to filterBool. If the result is true then contacts are generated for the shape pair.</p>
<p>Available operators (members of pFilterOp):</p>
<ul>
<li>FO_And - result = A &amp; B</li>
<li>FO_Or - result = A | B</li>
<li>FO_Xor - result = A ^ B</li>
<li>FO_Nand result = ~ (A &amp; B)</li>
<li>FO_Nor - result = ~ (A | B)</li>
<li>FO_NXor - result = ~ (A ^ B)</li>
</ul>
<p>results.bits0 = A.bits0 &amp; B.bits2;<br/>
 results.bits1 = A.bits1 &amp; B.bits3;<br/>
 results.bits2 = A.bits2 &amp; B.bits0;<br/>
 results.bits3 = A.bits3 &amp; B.bits1;<br/>
</p>
<p>To set the filter operators/constants and filterBool value, <a class="el" href="classp_world.html" title="Class to maintain physical objects.">pWorld</a> provides the following methods:</p>
<p>void <a class="el" href="classp_world.html#a1b0ef1289d704dfd014e5f704182de7e" title="Setups filtering operations. See comments for pGroupsMask.">pWorld::setFilterOps(pFilterOp op0, pFilterOp op1, pFilterOp op2)</a>; <br/>
 void <a class="el" href="classp_world.html#aab9935e5e1ece7f1b6cdb6e55003570e" title="Setups filtering&#39;s boolean value. See comments for pGroupsMask.">pWorld::setFilterBool(bool flag)</a>; <br/>
 void <a class="el" href="classp_world.html#abe005c4b63b45090d3f707e5a860b3f7" title="Setups filtering&#39;s K0 value. See comments for pGroupsMask.">pWorld::setFilterConstant0(const pGroupsMask&amp; mask)</a>; <br/>
 void <a class="el" href="classp_world.html#ab545ee15bc885a486cb2f293716c1611" title="Setups filtering&#39;s K1 value. See comments for pGroupsMask.">pWorld::setFilterConstant1(const pGroupsMask&amp; mask)</a>; <br/>
</p>
<p><a class="el" href="classp_groups_mask.html" title="128-bit mask used for collision filtering.">pGroupsMask</a> is a class which encapsulates a 128 bit value as a set of 32 bit values:</p>
<p>class <a class="el" href="classp_groups_mask.html" title="128-bit mask used for collision filtering.">pGroupsMask</a> <br/>
 { <br/>
 public: int bits0, bits1, bits2, bits3; <br/>
</p>
<p>};<br/>
</p>
<p>Finally, <a class="el" href="classp_rigid_body.html" title="pRigidBody is the main simulation object in the physics SDK.">pRigidBody</a> provides methods to set/get the group mask associated with the shape:<br/>
</p>
<p>void <a class="el" href="classp_rigid_body.html#afec9beee8ee11d301d3bc6347b0e17a0" title="Sets 128-bit mask used for collision filtering. See comments for pGroupsMask.">pRigidBody::setGroupsMask(CK3dEntity *shapeReference, const pGroupsMask&amp; mask)</a>; <br/>
 const <a class="el" href="classp_groups_mask.html" title="128-bit mask used for collision filtering.">pGroupsMask</a> pRigidBody::getGroupsMask(CK3dEntity *shapeReference) const;<br/>
</p>
<p>To set up the operators/constants, ensure that contacts between a pair of shapes are generated if their masks produce a non zero value when ANDed together:<br/>
</p>
<p>gWorld-&gt;setFilterOps(FO_Or, FO_Or,FO_And);<br/>
 void pWorld::setFilterBool(true);<br/>
 <a class="el" href="classp_groups_mask.html" title="128-bit mask used for collision filtering.">pGroupsMask</a> zeroMask;<br/>
 zeroMask.bits0=zeroMask.bits1=zeroMask.bits2=zeroMask.bits3=0; <br/>
 void pWorld::setFilterConstant0(zeroMask);<br/>
 void pWorld::setFilterConstant1(zeroMask);<br/>
</p>
<p>Setting the filter constants to zero and operators 0 and 1 to FO_Or effectively makes them no ops. The final NX_FILTEROP_AND causes the groupsMasks to be ANDed together and the result compared to the filterBool value producing the intended result.<br/>
</p>
<p>Note 1: Since it is undefined which of any two shapes checked for collision is assigned "G0" and which "G1" in the above formula, you should refrain from using filters that give different results depending on this assignment.</p>
<p>See <a href="pWFiltering.cmo">pWFiltering.cmo</a> for example. </p>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed Feb 3 18:57:23 2010 for vtPhysX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
